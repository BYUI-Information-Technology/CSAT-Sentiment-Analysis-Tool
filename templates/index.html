{% extends "base.html" %}

{% block title %}BYUI Sentiment Analysis - Upload File{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header text-center">
                <h2 class="mb-0">
                    <i class="fas fa-chart-line me-2"></i>
                    BYUI Sentiment Analysis Tool
                </h2>
                <p class="mb-0 mt-2 opacity-75">
                    Upload your Excel file and select which column to analyze for sentiment
                </p>
            </div>
            <div class="card-body p-5">
                <form action="{{ url_for('upload_file') }}" method="post" enctype="multipart/form-data"
                    onsubmit="showLoading()">
                    <div class="file-upload-area mb-4">
                        <div class="upload-text">
                            <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                            <h4 class="text-muted">Drag & Drop Excel File Here</h4>
                            <p class="text-muted">or click to browse files</p>
                            <p class="small text-muted">
                                Supported formats: .xlsx, .xls<br>
                                Maximum file size: 16MB
                            </p>
                        </div>
                        <input type="file" name="file" accept=".xlsx,.xls" required class="form-control-file d-none"
                            id="fileInput" aria-label="Upload Excel file for sentiment analysis">
                    </div>

                    <div class="text-center">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="fas fa-play me-2"></i>
                            Analyze Sentiment
                        </button>
                    </div>
                </form>

                <!-- Loading Spinner -->
                <div class="loading-spinner">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Processing...</span>
                    </div>
                    <h5 class="mt-3 text-muted">Processing your file...</h5>
                    <p class="text-muted">This may take a few moments depending on file size</p>
                </div>
            </div>
        </div>

        <!-- Instructions Card -->
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-info-circle me-2"></i>
                    How to Use
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6 class="text-primary">
                            <i class="fas fa-file-excel me-2"></i>
                            File Requirements
                        </h6>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-check text-success me-2"></i>Excel format (.xlsx or .xls)</li>
                            <li><i class="fas fa-check text-success me-2"></i>Contains text data for analysis</li>
                            <li><i class="fas fa-check text-success me-2"></i>Maximum 16MB file size</li>
                            <li><i class="fas fa-check text-success me-2"></i>Any number of columns supported</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6 class="text-primary">
                            <i class="fas fa-chart-bar me-2"></i>
                            What You'll Get
                        </h6>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-star text-warning me-2"></i>Interactive data preview with column
                                selection</li>
                            <li><i class="fas fa-star text-warning me-2"></i>Sentiment labels (Positive, Negative,
                                Neutral)</li>
                            <li><i class="fas fa-star text-warning me-2"></i>Confidence scores for each prediction</li>
                            <li><i class="fas fa-star text-warning me-2"></i>Beautiful visualizations and charts</li>
                            <li><i class="fas fa-star text-warning me-2"></i>Downloadable analyzed Excel file</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Example Card -->
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-lightbulb me-2"></i>
                    Example Data Format
                </h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-sm table-bordered">
                        <thead class="table-light">
                            <tr>
                                <th>Response</th>
                                <th>Ticket ID</th>
                                <th>Ticket</th>
                                <th>Survey Completed By</th>
                                <th>Survey Completed</th>
                                <th>Requested</th>
                                <th>Satisfied Range</th>
                                <th>Why satisfied text area</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Example response</td>
                                <td>12345</td>
                                <td>Support Request</td>
                                <td>John Doe</td>
                                <td>2024-01-15</td>
                                <td>2024-01-10</td>
                                <td>Very Satisfied</td>
                                <td>Great service! Really happy with the quality and fast response time.</td>
                            </tr>
                            <tr>
                                <td>Example response</td>
                                <td>12346</td>
                                <td>Technical Issue</td>
                                <td>Jane Smith</td>
                                <td>2024-01-16</td>
                                <td>2024-01-12</td>
                                <td>Dissatisfied</td>
                                <td>Poor customer support, very disappointed with the slow resolution.</td>
                            </tr>
                            <tr>
                                <td>Example response</td>
                                <td>12347</td>
                                <td>Information Request</td>
                                <td>Bob Johnson</td>
                                <td>2024-01-17</td>
                                <td>2024-01-14</td>
                                <td>Neutral</td>
                                <td>The service was okay, nothing special but got the job done.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="small text-muted mt-2">
                    <i class="fas fa-exclamation-circle me-1"></i>
                    Upload any Excel file and you'll be able to select which column contains the text to analyze for
                    sentiment.
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Make the file upload area clickable
    document.addEventListener('DOMContentLoaded', function () {
        const fileUploadArea = document.querySelector('.file-upload-area');
        const fileInput = document.querySelector('#fileInput');

        if (fileUploadArea && fileInput) {
            fileUploadArea.addEventListener('click', function () {
                fileInput.click();
            });
        }
    });
</script>
{% endblock %}